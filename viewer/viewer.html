<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claudeå¯¹è¯æŸ¥çœ‹å™¨ ğŸ¤–</title>
    <link rel="stylesheet" href="viewer.css">
    <!-- Markdownè§£æåº“ -->
    <script src="https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js"></script>
    <!-- ä»£ç é«˜äº®åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css">
    <!-- Mermaidå›¾è¡¨åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
</head>
<body>
    <div class="viewer-container">
        <!-- å¤´éƒ¨å¯¼èˆª -->
        <header class="viewer-header">
            <div class="header-content">
                <div class="header-left">
                    <h1 class="viewer-title">
                        <span class="title-icon">ğŸ¤–</span>
                        Claudeå¯¹è¯æŸ¥çœ‹å™¨
                    </h1>
                    <div class="viewer-subtitle">æ”¯æŒå¤šåˆ†æ”¯ã€Markdownã€ä»£ç é«˜äº®</div>
                </div>
                <div class="header-right">
                    <div class="header-controls">
                        <button class="control-btn" id="load-file-btn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                            </svg>
                            åŠ è½½æ–‡ä»¶
                        </button>
                        <button class="control-btn" id="tree-view-btn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M8,2H16A2,2 0 0,1 18,4V6A2,2 0 0,1 16,8H8A2,2 0 0,1 6,6V4A2,2 0 0,1 8,2M8,10H16A2,2 0 0,1 18,12V14A2,2 0 0,1 16,16H8A2,2 0 0,1 6,14V12A2,2 0 0,1 8,10M8,18H16A2,2 0 0,1 18,20V22A2,2 0 0,1 16,24H8A2,2 0 0,1 6,22V20A2,2 0 0,1 8,18Z"/>
                            </svg>
                            æ ‘å½¢è§†å›¾
                        </button>
                        <button class="control-btn" id="export-html-btn" disabled>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                            </svg>
                            å¯¼å‡ºHTML
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <main class="viewer-main">
            <!-- ä¸Šä¼ åŒºåŸŸ -->
            <div class="upload-area" id="upload-area">
                <div class="upload-content">
                    <div class="upload-icon">ğŸ“</div>
                    <h3>æ‹–æ‹½JSONæ–‡ä»¶åˆ°æ­¤å¤„</h3>
                    <p>æˆ–ç‚¹å‡»"åŠ è½½æ–‡ä»¶"æŒ‰é’®é€‰æ‹©æ–‡ä»¶</p>
                    <div class="upload-formats">
                        æ”¯æŒæ ¼å¼ï¼šClaudeå¯¼å‡ºçš„JSONæ–‡ä»¶
                    </div>
                </div>
            </div>

            <!-- åŠ è½½çŠ¶æ€ -->
            <div class="loading-state" id="loading-state" style="display: none;">
                <div class="loading-spinner"></div>
                <div class="loading-text">æ­£åœ¨è§£æå¯¹è¯æ•°æ®...</div>
            </div>

            <!-- å¯¹è¯å†…å®¹ -->
            <div class="conversation-container" id="conversation-container" style="display: none;">
                <!-- å¯¹è¯ä¿¡æ¯å¤´éƒ¨ -->
                <div class="conversation-header" id="conversation-header">
                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                </div>

                <!-- åˆ†æ”¯å¯¼èˆª -->
                <div class="branch-navigation" id="branch-navigation" style="display: none;">
                    <div class="branch-title">ğŸŒ³ å¯¹è¯åˆ†æ”¯</div>
                    <div class="branch-tree" id="branch-tree">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- æ¶ˆæ¯åˆ—è¡¨ -->
                <div class="messages-container" id="messages-container">
                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </main>

        <!-- ä¾§è¾¹æ  -->
        <aside class="viewer-sidebar" id="viewer-sidebar">
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <h3 class="sidebar-title">ğŸ“Š ç»Ÿè®¡ä¿¡æ¯</h3>
                    <div class="stats-grid" id="stats-grid">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3 class="sidebar-title">ğŸ”§ æ˜¾ç¤ºé€‰é¡¹</h3>
                    <div class="display-options">
                        <label class="option-item">
                            <input type="checkbox" id="show-timestamps" checked>
                            <span class="option-label">æ˜¾ç¤ºæ—¶é—´æˆ³</span>
                        </label>
                        <label class="option-item">
                            <input type="checkbox" id="show-attachments" checked>
                            <span class="option-label">æ˜¾ç¤ºé™„ä»¶</span>
                        </label>
                        <label class="option-item">
                            <input type="checkbox" id="show-tools" checked>
                            <span class="option-label">æ˜¾ç¤ºå·¥å…·ä½¿ç”¨</span>
                        </label>
                        <label class="option-item">
                            <input type="checkbox" id="show-metadata" checked>
                            <span class="option-label">æ˜¾ç¤ºå…ƒæ•°æ®</span>
                        </label>
                        <label class="option-item">
                            <input type="checkbox" id="render-markdown" checked>
                            <span class="option-label">æ¸²æŸ“Markdown</span>
                        </label>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3 class="sidebar-title">ğŸ¨ ä¸»é¢˜è®¾ç½®</h3>
                    <div class="theme-options">
                        <button class="theme-btn active" data-theme="light">æµ…è‰²</button>
                        <button class="theme-btn" data-theme="dark">æ·±è‰²</button>
                        <button class="theme-btn" data-theme="auto">è‡ªåŠ¨</button>
                    </div>
                </div>
            </div>
        </aside>

        <!-- ä¾§è¾¹æ åˆ‡æ¢æŒ‰é’® -->
        <button class="sidebar-toggle" id="sidebar-toggle">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"/>
            </svg>
        </button>
    </div>

    <!-- æ–‡ä»¶è¾“å…¥ -->
    <input type="file" id="file-input" accept=".json" style="display: none;">

    <!-- æ¨¡æ€æ¡† -->
    <div class="modal" id="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">æ ‡é¢˜</h3>
                <button class="modal-close" id="modal-close">Ã—</button>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- åŠ¨æ€å†…å®¹ -->
            </div>
        </div>
    </div>

    <script src="viewer.js"></script>
    <script>
        // ç›‘å¬æ¥è‡ªæµ‹è¯•é¡µé¢çš„æ¶ˆæ¯
        window.addEventListener('message', function(event) {
            if (event.data && event.data.type === 'loadData') {
                viewer.loadJsonData(event.data.data);
            }
        });
    </script>
</body>
</html>
