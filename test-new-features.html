<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–°åŠŸèƒ½æµ‹è¯• - Claudeå¯¹è¯å¯è§†åŒ–å™¨</title>
    <link rel="stylesheet" href="viewer/viewer.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: var(--background-color);
            color: var(--text-primary);
        }
        
        .test-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .test-section {
            margin-bottom: 3rem;
            padding: 2rem;
            background: var(--surface-color);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-color);
        }
        
        .test-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }
        
        .test-description {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }
        
        .feature-demo {
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .load-demo-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .load-demo-btn:hover {
            background: #5a6fd8;
            transform: translateY(-1px);
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸš€ æ–°åŠŸèƒ½é€‚é…æµ‹è¯•</h1>
        <p>æµ‹è¯•Claudeå¯¹è¯å¯è§†åŒ–å™¨å¯¹æ–°JSONæ ¼å¼çš„æ”¯æŒ</p>
        
        <div class="test-section">
            <div class="test-title">1. ğŸ¨ Artifactså·¥å…·æ”¯æŒ</div>
            <div class="test-description">æµ‹è¯•artifactså·¥å…·è°ƒç”¨çš„å¯è§†åŒ–æ•ˆæœ</div>
            
            <div class="feature-demo" id="artifactsDemo">
                <button class="load-demo-btn" onclick="loadArtifactsDemo()">åŠ è½½Artifactsæ¼”ç¤º</button>
            </div>
        </div>
        
        <div class="test-section">
            <div class="test-title">2. ğŸ” ç½‘ç»œæœç´¢ç»“æœ</div>
            <div class="test-description">æµ‹è¯•web_searchå·¥å…·çš„æœç´¢ç»“æœå±•ç¤º</div>
            
            <div class="feature-demo" id="searchDemo">
                <button class="load-demo-btn" onclick="loadSearchDemo()">åŠ è½½æœç´¢æ¼”ç¤º</button>
            </div>
        </div>
        
        <div class="test-section">
            <div class="test-title">3. ğŸ–¼ï¸ å›¾ç‰‡é™„ä»¶é¢„è§ˆ</div>
            <div class="test-description">æµ‹è¯•files_v2æ ¼å¼çš„å›¾ç‰‡é¢„è§ˆåŠŸèƒ½</div>
            
            <div class="feature-demo" id="imageDemo">
                <button class="load-demo-btn" onclick="loadImageDemo()">åŠ è½½å›¾ç‰‡æ¼”ç¤º</button>
            </div>
        </div>
        
        <div class="test-section">
            <div class="test-title">4. âš™ï¸ å¯¹è¯è®¾ç½®ä¿¡æ¯</div>
            <div class="test-description">æµ‹è¯•settingså­—æ®µçš„è§£æå’Œæ˜¾ç¤º</div>
            
            <div class="feature-demo" id="settingsDemo">
                <button class="load-demo-btn" onclick="loadSettingsDemo()">åŠ è½½è®¾ç½®æ¼”ç¤º</button>
            </div>
        </div>
        
        <div class="test-section">
            <div class="test-title">5. ğŸ“ å®Œæ•´JSONæµ‹è¯•</div>
            <div class="test-description">åŠ è½½çœŸå®çš„æ–°æ ¼å¼JSONæ–‡ä»¶è¿›è¡Œæµ‹è¯•</div>
            
            <div class="feature-demo">
                <button class="load-demo-btn" onclick="loadRealJson('claude_179bd8ff_2025-05-31.json')">
                    åŠ è½½æ•°æ®åº“è®¾è®¡å¯¹è¯
                </button>
                <button class="load-demo-btn" onclick="loadRealJson('claude_3e2cb7c5_2025-05-31.json')" style="margin-left: 10px;">
                    åŠ è½½AIä»£ç æ‰§è¡Œå¯¹è¯
                </button>
                <button class="load-demo-btn" onclick="loadRealJson('claude_946a2b2a_2025-05-31.json')" style="margin-left: 10px;">
                    åŠ è½½å·¥å…·æµ‹è¯•å¯¹è¯
                </button>
            </div>
        </div>
    </div>

    <script src="viewer.js"></script>
    <script>
        // æ¼”ç¤ºæ•°æ®
        function loadArtifactsDemo() {
            // åˆ›å»ºartifactsæ¼”ç¤º
            const createArtifact = {
                name: 'artifacts',
                input: {
                    id: 'python_demo',
                    type: 'application/vnd.ant.code',
                    title: 'ç®€å•Pythonç¤ºä¾‹',
                    command: 'create',
                    content: 'def greet(name):\n    """ç®€å•çš„é—®å€™å‡½æ•°"""\n    return f"ä½ å¥½, {name}!"\n\n# æµ‹è¯•å‡½æ•°\nprint(greet("Claude"))\nprint("è¿™æ˜¯ä¸€ä¸ªPythonä»£ç ç¤ºä¾‹")',
                    language: 'python'
                }
            };

            // æ›´æ–°artifactsæ¼”ç¤º
            const updateArtifact = {
                name: 'artifacts',
                input: {
                    id: 'python_demo',
                    command: 'update',
                    title: 'æ›´æ–°Pythonç¤ºä¾‹',
                    language: 'python',
                    old_str: 'print(greet("Claude"))\nprint("è¿™æ˜¯ä¸€ä¸ªPythonä»£ç ç¤ºä¾‹")',
                    new_str: 'print(greet("Claude"))\nprint(greet("ä¸–ç•Œ"))\nprint("è¿™æ˜¯ä¸€ä¸ªæ›´æ–°çš„Pythonä»£ç ç¤ºä¾‹")'
                }
            };

            const artifactsResult = {
                content: [
                    { type: 'text', text: 'OK' }
                ],
                is_error: false
            };

            const demo = document.getElementById('artifactsDemo');
            demo.innerHTML = `
                <h4>åˆ›å»ºArtifacts:</h4>
                ${renderToolUse(createArtifact)}
                ${renderToolResult(artifactsResult)}
                <h4 style="margin-top: 2rem;">æ›´æ–°Artifacts:</h4>
                ${renderToolUse(updateArtifact)}
                ${renderToolResult(artifactsResult)}
            `;
        }
        
        function loadSearchDemo() {
            const searchToolUse = {
                name: 'web_search',
                input: {
                    query: 'AI code execution sandbox implementation browser javascript 2024'
                }
            };
            
            const searchResult = {
                content: [
                    {
                        type: 'knowledge',
                        title: 'JavaScript Sandboxing for Secure Code Testing',
                        url: 'https://example.com/js-sandbox',
                        metadata: {
                            site_domain: 'example.com',
                            site_name: 'Tech Blog',
                            favicon_url: 'https://example.com/favicon.ico'
                        },
                        text: 'JavaScript sandboxing provides a secure way to execute untrusted code in isolated environments...'
                    },
                    {
                        type: 'knowledge',
                        title: 'WebContainers: Browser-based Development',
                        url: 'https://webcontainers.io',
                        metadata: {
                            site_domain: 'webcontainers.io',
                            site_name: 'WebContainers'
                        },
                        text: 'WebContainers enable full Node.js environments to run directly in the browser using WebAssembly...'
                    },
                    {
                        type: 'text',
                        text: 'Found 2 relevant results about browser-based code execution.'
                    }
                ],
                is_error: false
            };
            
            const demo = document.getElementById('searchDemo');
            demo.innerHTML = renderToolUse(searchToolUse) + renderToolResult(searchResult);
        }
        
        function loadImageDemo() {
            const imageFiles = [
                {
                    file_kind: 'image',
                    file_name: 'diagram.png',
                    created_at: '2025-05-30T17:00:10.055400+00:00',
                    thumbnail_url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPuekuuS+i+WbvueJhzwvdGV4dD48L3N2Zz4=',
                    preview_url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyNCIgZmlsbD0iIzY2NiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPuekuuS+i+WbvueJhzwvdGV4dD48L3N2Zz4=',
                    thumbnail_asset: {
                        image_width: 200,
                        image_height: 150
                    }
                }
            ];
            
            const demo = document.getElementById('imageDemo');
            demo.innerHTML = renderAttachments([], [], imageFiles);
        }
        
        function loadSettingsDemo() {
            const conversationData = {
                name: 'åŠŸèƒ½æµ‹è¯•å¯¹è¯',
                summary: 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å¯¹è¯ï¼Œå±•ç¤ºæ–°çš„åŠŸèƒ½ç‰¹æ€§',
                uuid: 'test-uuid-12345',
                created_at: '2025-05-30T17:00:00.000Z',
                updated_at: '2025-05-30T17:30:00.000Z',
                is_starred: true,
                current_leaf_message_uuid: 'leaf-uuid-67890',
                settings: {
                    preview_feature_uses_artifacts: true,
                    enabled_web_search: true
                },
                chat_messages: [
                    { uuid: '1' },
                    { uuid: '2' },
                    { uuid: '3' }
                ]
            };
            
            const demo = document.getElementById('settingsDemo');
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = '<div id="tempConversationInfo"></div>';
            
            // ä¸´æ—¶è®¾ç½®conversationInfoå…ƒç´ 
            const originalElement = window.conversationInfo;
            window.conversationInfo = tempDiv.querySelector('#tempConversationInfo');
            
            renderConversationInfo(conversationData);
            demo.innerHTML = window.conversationInfo.innerHTML;
            
            // æ¢å¤åŸå§‹å…ƒç´ 
            window.conversationInfo = originalElement;
        }
        
        function loadRealJson(filename) {
            fetch(`æ–°jsoné€‚é…/${filename}`)
                .then(response => response.json())
                .then(data => {
                    // åœ¨æ–°çª—å£ä¸­æ‰“å¼€å¯è§†åŒ–å™¨
                    const newWindow = window.open('viewer.html', '_blank');
                    newWindow.addEventListener('load', () => {
                        newWindow.postMessage({
                            type: 'LOAD_JSON',
                            data: data
                        }, '*');
                    });
                })
                .catch(error => {
                    alert('åŠ è½½æ–‡ä»¶å¤±è´¥: ' + error.message);
                });
        }
    </script>
</body>
</html>
